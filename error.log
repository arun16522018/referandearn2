<?php
namespace App;

class Logger {
    private static $logFile;
    
    public static function init(string $path): void {
        self::$logFile = $path;
        register_shutdown_function([self::class, 'checkForFatal']);
    }
    
    public static function log(string $message, string $level = 'INFO'): void {
        $entry = sprintf(
            "[%s] %s: %s\n",
            date('Y-m-d H:i:s'),
            $level,
            $message
        );
        file_put_contents(self::$logFile, $entry, FILE_APPEND);
    }
    
    public static function checkForFatal(): void {
        $error = error_get_last();
        if ($error && in_array($error['type'], [E_ERROR, E_PARSE, E_CORE_ERROR, E_COMPILE_ERROR])) {
            self::log($error['message'], 'FATAL');
        }
    }
}
